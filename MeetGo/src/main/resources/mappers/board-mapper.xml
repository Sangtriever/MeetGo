<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "mybatis-3-mapper.dtd" >
<mapper namespace="boardMapper">
	
	<resultMap id="replyResultSet" type="reply">
		<result column="REPLY_NO" property="replyNo" />
		<result column="REPLY_CONTENT" property="replyContent" />
		<result column="REPLY_DATE" property="replyDate" />
		<result column="REPLY_STATUS" property="replyStatus" />
		<result column="BOARD_NO" property="boardNo" />
		<result column="USER_NO" property="userNo" />
	</resultMap>
		
		

	<resultMap id="boardResultSet" type="board">
		<result column="BOARD_NO" property="boardNo" />
		<result column="BOARD_TITLE" property="boardTitle" />
		<result column="BOARD_CONTENT" property="boardContent" />
		<result column="BOARD_CREATE_DATE" property="createDate" /> <!-- 별칭 -->		
		<result column="BOARD_UPDATE_DATE" property="boardUpdate" /> 		
		<result column="BOARD_COUNT" property="boardCount" />	
		<result column="BOARD_TYPE" property="boardType" />	
		<result column="USER_NO" property="userNo" />		
	</resultMap>

	
	<select id="selectListCount" resultType="_int">
		SELECT COUNT(*)
		  FROM BOARD
		 WHERE BOARD_TYPE = 1
	</select>
	

	<select id="selectList" resultMap="boardResultSet">
		SELECT BOARD_NO
		     , BOARD_TITLE
		     , TO_CHAR(BOARD_CREATE_DATE, 'YYYY-MM-DD') AS "BOARD_CREATE_DATE"
			 , BOARD_COUNT
		  FROM BOARD
		 WHERE BOARD_TYPE = 1
		 ORDER BY BOARD_NO DESC
	</select>
	
	<insert id="insertBoard" parameterType="Board">
			    INSERT INTO BOARD (
			        BOARD_NO,
			        BOARD_TITLE,
			        BOARD_CONTENT,
			        BOARD_CREATE_DATE,
			        USER_NO,
			        BOARD_TYPE
			        )
			         VALUES(SEQ_BOARD_NO.NEXTVAL
			         ,#{boardTitle}
			         ,#{boardContent}
			         ,#{createDate}
			         , 1
			         , 1
			        )
		</insert>	
			<insert id="insertTipboard" parameterType="Board">
			    INSERT INTO BOARD (
			        BOARD_NO,
			        BOARD_TITLE,
			        BOARD_CONTENT,
			        BOARD_CREATE_DATE )
			         VALUES(SEQ_BOARD_NO.NEXTVAL
			         ,#{boardTitle}
			         ,#{boardContent}
			         ,#{createDate}
			         )
		    
		</insert>				

	<select id="selectBoard" parameterType="_int" resultMap="boardResultSet">
		SELECT BOARD_NO
		     , BOARD_TITLE
		     , TO_CHAR(BOARD_CREATE_DATE, 'YYYY-MM-DD') AS "CREATE_DATE"
		     , BOARD_CONTENT
		     
		  FROM BOARD
		 WHERE BOARD_NO = #{boardNo}
		   AND BOARD_TYPE = 1
	</select>
	
	<update id="increaseCount" parameterType="_int">
		UPDATE BOARD
		   SET BOARD_COUNT = BOARD_COUNT + 1
		 WHERE BOARD_NO = #{boardNo}
		   AND BOARD_TYPE = 1
	</update>
	
	<select id="selectReplyList" parameterType="_int" resultMap="replyResultSet">
		SELECT REPLY_NO		   
		     , REPLY_CONTENT
		     , TO_CHAR(REPLY_DATE, 'YYYY-MM-DD') AS "REPLY_DATE"
		  FROM REPLY
		 WHERE REPLY_STATUS = 'Y'
		   AND REF_BNO = #{boardNo}
		 ORDER BY REPLY_NO DESC
	</select>
	
	<insert id="insertReply" parameterType="reply">
		INSERT INTO REPLY(REPLY_NO
		                , REPLY_CONTENT
		                , REF_BNO
		                )
		           VALUES(SEQ_BOARD_NO.NEXTVAL
		                , #{replyContent}
		                , #{refBoardNo}
		                )
	</insert>


</mapper>








